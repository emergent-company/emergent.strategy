############################################
# Core Services & Database
############################################
ORGS_DEMO_SEED=false
SKIP_DB=false

# Authorization - Disable scope enforcement (set to 1 to bypass @Scopes() decorators)
SCOPES_DISABLED=1

AUTH_ISSUER=http://localhost:8200
AUTH_JWKS_URI=http://localhost:8200/oauth/v2/keys

# Embeddings via Vertex AI (uses Application Default Credentials)
EMBEDDING_PROVIDER=vertex
VERTEX_EMBEDDING_MODEL=text-embedding-004
VERTEX_EMBEDDING_PROJECT=spec-server-dev
VERTEX_EMBEDDING_LOCATION=europe-north1

POSTGRES_HOST=localhost
POSTGRES_PORT=5437
POSTGRES_USER=spec
POSTGRES_PASSWORD=spec
POSTGRES_DB=spec
NAMESPACE=spec-server-2
# Canonical ports
ADMIN_PORT=5176
SERVER_PORT=3002

# Zitadel Configuration
ZITADEL_DOMAIN=localhost:8200
ZITADEL_HTTP_PORT=8200
ZITADEL_LOGIN_PORT=8201

# Debug logging
E2E_DEBUG_CHAT=1

############################################
# Self-hosted ZITADEL (dev) bootstrap config
############################################
# Master key must have 32 characters. DEV ONLY.
ZITADEL_MASTERKEY=MasterkeyNeedsToHave32Characters

# External access (how the browser reaches Zitadel)
ZITADEL_EXTERNALDOMAIN=localhost
ZITADEL_EXTERNALSECURE=false
ZITADEL_TLS_ENABLED=false

# Database (PostgreSQL) — uses existing service `db`
ZITADEL_DATABASE_POSTGRES_HOST=db
ZITADEL_DATABASE_POSTGRES_PORT=5437
ZITADEL_DATABASE_POSTGRES_DATABASE=zitadel

# Runtime user Zitadel will use
ZITADEL_DATABASE_POSTGRES_USER_USERNAME=zitadel
ZITADEL_DATABASE_POSTGRES_USER_PASSWORD=zitadel
ZITADEL_DATABASE_POSTGRES_USER_SSL_MODE=disable

# First instance & Login v2
ZITADEL_FIRSTINSTANCE_ORG_NAME="Spec, Inc."
ZITADEL_FIRSTINSTANCE_LOGINCLIENTPATPATH=/current-dir/login-client.pat
ZITADEL_DEFAULTINSTANCE_FEATURES_LOGINV2_REQUIRED=true
ZITADEL_DEFAULTINSTANCE_FEATURES_LOGINV2_BASEURI=http://localhost:8201/ui/v2/login
ZITADEL_OIDC_DEFAULTLOGINURLV2=http://localhost:8201/ui/v2/login/login?authRequest=
ZITADEL_OIDC_DEFAULTLOGOUTURLV2=http://localhost:8201/ui/v2/login/logout?post_logout_redirect=

# Bootstrap first instance (org and admin)
# Documentation: https://zitadel.com/docs/self-hosting/manage/configure
ZITADEL_FIRSTINSTANCE_ORG_HUMAN_USERNAME=root
ZITADEL_FIRSTINSTANCE_ORG_HUMAN_PASSWORD=RootPassword1!

############################################
# OIDC (Backend) – using hosted Zitadel only
############################################
ZITADEL_ISSUER=http://localhost:8200
ZITADEL_CLIENT_ID=345644688558063619
ZITADEL_REDIRECT_URI=http://localhost:5176/auth/callback

############################################
# Frontend (Vite) Auth Variables
############################################
VITE_ZITADEL_ISSUER=http://localhost:8200
VITE_ZITADEL_CLIENT_ID=345644688558063619
VITE_ZITADEL_REDIRECT_URI=http://localhost:5176/auth/callback
VITE_ZITADEL_POST_LOGOUT_REDIRECT_URI=http://localhost:5176/
VITE_ZITADEL_SCOPES=openid profile email documents:read chunks:read chat:read search:read
# Optional audience (comment out if unused)
# VITE_ZITADEL_AUDIENCE=
VITE_AUTH_MODE=oidc
# Passkey feature flag removed (no custom passkey flow).
# VITE_API_BASE is used by the admin frontend to construct API URLs
# In development: Leave empty to use Vite proxy (recommended)
# In production: can be empty (proxied by web server) or absolute URL
# VITE_API_BASE=http://localhost:3001

# Optional: SMTP for email verification (disabled by default)
# ZITADEL_SMTP_HOST=
# ZITADEL_SMTP_USER=
# ZITADEL_SMTP_PASSWORD=
# ZITADEL_SMTP_FROM=

############################################
# E2E Test Configuration
############################################
E2E_AUTH_TOKEN=""
E2E_REAL_LOGIN=1
E2E_OIDC_EMAIL="maciej@kucharz.net"
E2E_OIDC_PASSWORD="Test1234!"
# Point E2E tests to the admin dev server (defaults to ADMIN_PORT or 5175)
E2E_BASE_URL=http://localhost:5176
E2E_OIDC_BAD_PASSWORD="___definitely_wrong__"
ZITADEL_PASSWORD_GRANT=true

############################################
# Extraction Worker Configuration
############################################
EXTRACTION_WORKER_ENABLED=true
EXTRACTION_WORKER_POLL_INTERVAL_MS=5000
EXTRACTION_WORKER_BATCH_SIZE=5
# Conservative rate limits for Vertex AI free tier to avoid HTTP 429 errors
EXTRACTION_RATE_LIMIT_RPM=60
EXTRACTION_RATE_LIMIT_TPM=30000
EXTRACTION_ENTITY_LINKING_STRATEGY=always_new
EXTRACTION_CONFIDENCE_THRESHOLD_MIN=0.0

GOOGLE_REDIRECT_URL="http://localhost:5176/oauth/callback"
GCP_PROJECT_ID=spec-server-dev
GOOGLE_CLOUD_PROJECT=spec-server-dev
GOOGLE_CLOUD_LOCATION=europe-north1

VERTEX_AI_PROJECT_ID=spec-server-dev
# Using gemini-2.5-flash (faster and cheaper than gemini-2.5-pro)
VERTEX_AI_MODEL=gemini-2.5-flash

# 32-character encryption key for integration credentials (AES-256)
INTEGRATION_ENCRYPTION_KEY=8136717f14c0c39d810059da143ba0dc
