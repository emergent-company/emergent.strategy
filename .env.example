# =============================================================================
# ROOT .ENV - WORKSPACE & SHARED CONFIGURATION
# =============================================================================
# 
# This file contains SAFE DEFAULTS for workspace-wide configuration.
# It is COMMITTED to the repository and should NOT contain secrets.
#
# ORGANIZATION:
# - Root .env         → Workspace/shared variables (THIS FILE)
# - Root .env.local   → User overrides & secrets (GITIGNORED)
# - apps/server/.env  → Server application variables
# - apps/admin/.env   → Admin frontend variables
#
# LOADING PRECEDENCE:
# .env.local overrides .env (when both exist)
#
# SECRETS POLICY:
# - Keep secrets in .env.local (never committed)
# - This file contains only safe defaults
# =============================================================================

# -----------------------------------------------------------------------------
# Environment Configuration
# -----------------------------------------------------------------------------
# Environment type - determines which Infisical environment to use (REQUIRED)
# Options: local | dev | staging | production
# Used by: bootstrap scripts, env-init.sh, env-export.sh
# This sets the default environment for all scripts that interact with Infisical
ENVIRONMENT=local

# -----------------------------------------------------------------------------
# Infisical Configuration
# -----------------------------------------------------------------------------
# Infisical authentication token (REQUIRED for remote environments) (SECRET)
# Get your token from: https://infiscal.kucharz.net
# For local development, this can be omitted if using `infisical login`
# For CI/CD and remote environments, set this in .env.local
# INFISICAL_TOKEN=st.your-token-here

# Infisical Host (REQUIRED for self-hosted Infisical)
# Our self-hosted instance: infiscal.kucharz.net
# For Infisical Cloud, leave this unset (scripts will use app.infisical.com)
# Scripts will automatically construct the API URL: https://{host}/api
# INFISICAL_HOST=infiscal.kucharz.net

# Infisical Project ID (REQUIRED if using service tokens)
# This is fixed for this project
# INFISICAL_PROJECT_ID=2c273128-5d01-4156-a134-be9511d99c61

# -----------------------------------------------------------------------------
# Workspace Process Management
# -----------------------------------------------------------------------------
# Namespace for PM2 processes to avoid conflicts with other projects (REQUIRED)
# Used by: tools/workspace-cli
NAMESPACE=spec-server-2

# -----------------------------------------------------------------------------
# Service Ports
# -----------------------------------------------------------------------------
# Admin frontend port (REQUIRED)
ADMIN_PORT=5176

# Server backend port (REQUIRED)
SERVER_PORT=3002

# -----------------------------------------------------------------------------
# Zitadel Configuration
# -----------------------------------------------------------------------------
# NOTE: Zitadel is now deployed independently in ../emergent-infra/zitadel/
# See ../emergent-infra/zitadel/README.md for deployment instructions
#
# Zitadel domain for OIDC authentication (REQUIRED)
# Used by: apps communicate via this domain
# Default points to the independent Zitadel deployment on port 8080
ZITADEL_DOMAIN=localhost:8080

# -----------------------------------------------------------------------------
# Test User Configuration
# -----------------------------------------------------------------------------
# Two separate test users are created during bootstrap:
# 1. TEST_USER_* - For manual testing and development
# 2. E2E_TEST_USER_* - For automated E2E tests
# Bootstrap script will create both users if they don't exist

# E2E Test User email (OPTIONAL)
E2E_TEST_USER_EMAIL=e2e-test@example.com

# E2E Test User password (OPTIONAL) (SECRET)
E2E_TEST_USER_PASSWORD=E2eTestPassword123!

# Manual Test User email (OPTIONAL)
TEST_USER_EMAIL=test@example.com

# Manual Test User password (OPTIONAL) (SECRET)
TEST_USER_PASSWORD=TestPassword123!

# -----------------------------------------------------------------------------
# External Tools & Scripts Configuration
# -----------------------------------------------------------------------------
# These variables are NOT used by the application code itself, but by:
# - MCP servers (Model Context Protocol) - database access for AI tools
# - Development scripts in scripts/ directory
# - Testing utilities
# - CLI tools like Gemini Code Assist
#
# They can be placed in root .env for convenience when using these tools,
# even though they are technically "server" variables. This avoids the need
# to duplicate them across multiple .env files for external tool access.

# Database connection for MCP Postgres server (OPTIONAL)
# Used by: scripts/mcp-postgres-wrapper.sh, .vscode/mcp.json, .gemini/settings.json
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=spec
POSTGRES_DB=spec

# Note: POSTGRES_PASSWORD should be in .env.local (SECRET)
# It's also needed by MCP tools but must not be committed

# Google Cloud / Vertex AI configuration for scripts (OPTIONAL)
# Used by: scripts/test-vertex-ai-credentials.mjs and other development scripts
GCP_PROJECT_ID=spec-server
VERTEX_AI_LOCATION=us-central1
VERTEX_AI_MODEL=gemini-2.5-flash-lite

# -----------------------------------------------------------------------------
# NOTES
# -----------------------------------------------------------------------------
# 
# SERVER VARIABLES: See apps/server/.env.example
# - Database configuration (POSTGRES_*)
# - API keys (GOOGLE_API_KEY, etc.)
# - LLM/Extraction configuration
# - Authentication backend settings
#
# ADMIN VARIABLES: See apps/admin/.env.example  
# - Frontend configuration (VITE_*)
# - OIDC client settings
# - API connection settings
#
# USER OVERRIDES: Create .env.local to override any value above
# Example .env.local:
#   ADMIN_PORT=5177
#   SERVER_PORT=3003
#   NAMESPACE=my-custom-namespace
#
