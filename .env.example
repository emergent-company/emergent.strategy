# =============================================================================
# ROOT .ENV - WORKSPACE & SHARED CONFIGURATION
# =============================================================================
# 
# This file contains SAFE DEFAULTS for workspace-wide configuration.
# It is COMMITTED to the repository and should NOT contain secrets.
#
# ORGANIZATION:
# - Root .env         → Workspace/shared variables (THIS FILE)
# - Root .env.local   → User overrides & secrets (GITIGNORED)
# - apps/server/.env  → Server application variables
# - apps/admin/.env   → Admin frontend variables
#
# LOADING PRECEDENCE:
# .env.local overrides .env (when both exist)
#
# SECRETS POLICY:
# - Keep secrets in .env.local (never committed)
# - This file contains only safe defaults
# =============================================================================

# -----------------------------------------------------------------------------
# Environment Configuration
# -----------------------------------------------------------------------------
# Environment type (for organizational purposes)
# Options: local | dev | staging | production
ENVIRONMENT=local

# -----------------------------------------------------------------------------
# Workspace Process Management
# -----------------------------------------------------------------------------
# Namespace for PM2 processes to avoid conflicts with other projects (REQUIRED)
# Used by: tools/workspace-cli
NAMESPACE=spec-server-2

# -----------------------------------------------------------------------------
# Service Ports
# -----------------------------------------------------------------------------
# Admin frontend port (REQUIRED)
ADMIN_PORT=5176

# Server backend port (REQUIRED)
SERVER_PORT=3002

# -----------------------------------------------------------------------------
# Zitadel Configuration
# -----------------------------------------------------------------------------
# NOTE: Zitadel is now deployed independently in ../emergent-infra/zitadel/
# See ../emergent-infra/zitadel/README.md for deployment instructions
#
# Zitadel domain for OIDC authentication (REQUIRED)
# Used by: apps communicate via this domain
# Default points to the independent Zitadel deployment on port 8080
ZITADEL_DOMAIN=localhost:8080

# -----------------------------------------------------------------------------
# Test User Configuration
# -----------------------------------------------------------------------------
# Two separate test users are created during bootstrap:
# 1. TEST_USER_* - For manual testing and development
# 2. E2E_TEST_USER_* - For automated E2E tests
# Bootstrap script will create both users if they don't exist

# E2E Test User email (OPTIONAL)
E2E_TEST_USER_EMAIL=e2e-test@example.com

# E2E Test User password (OPTIONAL) (SECRET)
E2E_TEST_USER_PASSWORD=E2eTestPassword123!

# Manual Test User email (OPTIONAL)
TEST_USER_EMAIL=test@example.com

# Manual Test User password (OPTIONAL) (SECRET)
TEST_USER_PASSWORD=TestPassword123!

# -----------------------------------------------------------------------------
# External Tools & Scripts Configuration
# -----------------------------------------------------------------------------
# These variables are NOT used by the application code itself, but by:
# - MCP servers (Model Context Protocol) - database access for AI tools
# - Development scripts in scripts/ directory
# - Testing utilities
# - CLI tools like Gemini Code Assist
#
# They can be placed in root .env for convenience when using these tools,
# even though they are technically "server" variables. This avoids the need
# to duplicate them across multiple .env files for external tool access.

# Database connection for MCP Postgres server (OPTIONAL)
# Used by: scripts/mcp-postgres-wrapper.sh, .vscode/mcp.json, .gemini/settings.json
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=spec
POSTGRES_DB=spec

# Note: POSTGRES_PASSWORD should be in .env.local (SECRET)
# It's also needed by MCP tools but must not be committed

# Google Cloud / Vertex AI configuration for scripts (OPTIONAL)
# Used by: scripts/test-vertex-ai-credentials.mjs and other development scripts
GCP_PROJECT_ID=spec-server
VERTEX_AI_LOCATION=us-central1
VERTEX_AI_MODEL=gemini-2.5-flash-lite

# -----------------------------------------------------------------------------
# Storage Configuration (MinIO / S3-compatible)
# -----------------------------------------------------------------------------
# NOTE: MinIO is now deployed independently in ../emergent-infra/kreuzberg/
# See ../emergent-infra/kreuzberg/README.md for deployment instructions
#
# Storage provider type (OPTIONAL)
# Options: minio | s3 | gcs
STORAGE_PROVIDER=minio

# MinIO/S3 endpoint URL (REQUIRED for storage features)
# Default points to the independent MinIO deployment on port 9010
STORAGE_ENDPOINT=http://localhost:9010

# Storage credentials (OPTIONAL - set in .env.local for security)
# Default MinIO credentials for local development
STORAGE_ACCESS_KEY=minioadmin
# STORAGE_SECRET_KEY should be in .env.local (SECRET)

# Storage bucket names (OPTIONAL)
STORAGE_BUCKET_DOCUMENTS=documents
STORAGE_BUCKET_TEMP=document-temp

# Storage region (OPTIONAL)
STORAGE_REGION=us-east-1

# -----------------------------------------------------------------------------
# Kreuzberg Document Parsing Service
# -----------------------------------------------------------------------------
# NOTE: Kreuzberg is deployed alongside MinIO in ../emergent-infra/kreuzberg/
#
# Kreuzberg service URL (REQUIRED for document parsing)
KREUZBERG_SERVICE_URL=http://localhost:8000

# Kreuzberg service timeout in milliseconds (OPTIONAL)
KREUZBERG_SERVICE_TIMEOUT=300000

# Enable Kreuzberg document parsing (OPTIONAL)
# KREUZBERG_ENABLED=true

# -----------------------------------------------------------------------------
# Document Parsing Worker
# -----------------------------------------------------------------------------
# Enable background document parsing worker (OPTIONAL)
# DOCUMENT_PARSING_WORKER_ENABLED=true

# Worker poll interval in milliseconds (OPTIONAL)
DOCUMENT_PARSING_WORKER_POLL_INTERVAL_MS=5000

# Number of documents to process per batch (OPTIONAL)
DOCUMENT_PARSING_WORKER_BATCH_SIZE=5

# -----------------------------------------------------------------------------
# NOTES
# -----------------------------------------------------------------------------
# 
# SERVER VARIABLES: See apps/server/.env.example
# - Database configuration (POSTGRES_*)
# - API keys (GOOGLE_API_KEY, etc.)
# - LLM/Extraction configuration
# - Authentication backend settings
#
# ADMIN VARIABLES: See apps/admin/.env.example  
# - Frontend configuration (VITE_*)
# - OIDC client settings
# - API connection settings
#
# USER OVERRIDES: Create .env.local to override any value above
# Example .env.local:
#   ADMIN_PORT=5177
#   SERVER_PORT=3003
#   NAMESPACE=my-custom-namespace
#
