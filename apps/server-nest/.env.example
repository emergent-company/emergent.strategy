# Server Nest .env example
# Copy to .env and adjust values.

# --- Core Server ---
PORT=3001

# --- Postgres ---
PGHOST=localhost
PGPORT=5432
PGUSER=spec
PGPASSWORD=spec
PGDATABASE=spec
DB_AUTOINIT=true
# Set to any non-empty value to skip DB init (used for some test contexts)
# SKIP_DB=1

# Seed demo orgs/projects (optional boolean: true/false)
ORGS_DEMO_SEED=false

# --- Embeddings & LLM Extraction (Google Generative AI) ---
# Google Gemini API key for:
#   - Document embeddings (semantic search)
#   - LLM entity extraction (requirements, decisions, features, etc.)
#   - Chat model
# Get your key from: https://makersuite.google.com/app/apikey
# IMPORTANT: This file overrides the root .env file due to dotenv loading order
# Set the key HERE for server-specific configuration
GOOGLE_API_KEY=

# To run real embeddings integration test:
# RUN_EMBEDDINGS_IT=true npx vitest run tests/embeddings.service.real.spec.ts

# --- Extraction Worker (Google Vertex AI) ---
# Required for LLM-based entity extraction from documents
VERTEX_AI_PROJECT_ID=
VERTEX_AI_LOCATION=us-central1
VERTEX_AI_MODEL=gemini-1.5-pro-002

# Worker behavior
EXTRACTION_WORKER_ENABLED=false
EXTRACTION_WORKER_POLL_INTERVAL_MS=5000
EXTRACTION_WORKER_BATCH_SIZE=5

# Rate limiting (API quotas)
EXTRACTION_RATE_LIMIT_RPM=60
EXTRACTION_RATE_LIMIT_TPM=30000

# Entity linking strategy: always_new | key_match | vector_similarity | user_review
EXTRACTION_ENTITY_LINKING_STRATEGY=always_new

# Confidence thresholds (0.0-1.0)
EXTRACTION_CONFIDENCE_THRESHOLD_MIN=0.0
EXTRACTION_CONFIDENCE_THRESHOLD_REVIEW=0.7
EXTRACTION_CONFIDENCE_THRESHOLD_AUTO=0.85
