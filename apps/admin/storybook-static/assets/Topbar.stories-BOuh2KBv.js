import{r as c,j as e,c as O,a as _,L as k}from"./iframe-BQqEPkXj.js";import{T as B}from"./index-BtHTfJgj.js";import{I as i}from"./index-CqALXU3L.js";import"./preload-helper-D9Z9MdNV.js";const A=()=>{const[s]=c.useState(1),a=()=>document.activeElement instanceof HTMLElement&&document.activeElement.blur();return e.jsxs("div",{className:"dropdown-bottom dropdown sm:dropdown-end dropdown-center",children:[e.jsxs("div",{tabIndex:0,role:"button",className:"relative btn btn-circle btn-ghost btn-sm","aria-label":"Notifications",children:[e.jsx(i,{icon:"lucide--bell",className:"size-4.5 motion-preset-seesaw"}),e.jsx("div",{className:"top-1 absolute status status-error status-sm end-1"})]}),e.jsx("div",{tabIndex:0,className:"bg-base-100 shadow-md hover:shadow-lg mt-1 rounded-box w-84 duration-1000 dropdown-content",children:e.jsx("div",{className:"bg-base-200/30 ps-4 pe-2 pt-3 border-b border-base-200 rounded-t-box",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"font-medium",children:"Notification"}),e.jsx("button",{className:"btn btn-xs btn-circle btn-ghost","aria-label":"Close",onClick:a,children:e.jsx(i,{icon:"lucide--x",className:"size-4"})})]})})})]})};A.__docgenInfo={description:"",methods:[],displayName:"TopbarNotificationButton"};function S(s){return s?s.trim().toLowerCase():void 0}const M={VITE_API_BASE:"http://localhost:3001"};function P(){const{getAccessToken:s}=O(),{config:{activeOrgId:a,activeProjectId:p}}=_(),N=c.useMemo(()=>(M||{}).VITE_API_BASE||`${window.location.protocol}//${window.location.hostname}:3001`,[]),h=c.useCallback((d={})=>{const l={};d.json!==!1&&(l["Content-Type"]="application/json");const u=s?.();return u&&(l.Authorization=`Bearer ${u}`),a&&(l["X-Org-ID"]=a),p&&(l["X-Project-ID"]=p),l},[s,a,p]),x=c.useCallback(async(d,l={})=>{const{method:u="GET",body:t,headers:o,credentials:b,json:j}=l,g=await fetch(d,{method:u,headers:{...h({json:j!==!1}),...o||{}},body:typeof t>"u"?void 0:j===!1?t:JSON.stringify(t),credentials:b});if(!g.ok){let n=`Request failed (${g.status})`;try{const v=await g.json(),m=v.error;if(typeof m=="string")n=m;else if(m&&typeof m=="object"){if(m.message&&(n=m.message),m.details&&typeof m.details=="object"){const r=Object.keys(m.details)[0],f=r?m.details[r]:void 0;Array.isArray(f)&&f.length>0&&(!n||n.toLowerCase().includes("validation")?n=f[0]:n=`${n}: ${f[0]}`)}!n&&m.code&&(n=m.code)}else v.message&&(n=v.message);n&&typeof n!="string"&&(n=JSON.stringify(n))}catch{try{const v=await g.text();v&&(n=v)}catch{}}throw new Error(n||`Request failed (${g.status})`)}return g.status===204?void 0:await g.json()},[h]),w=c.useCallback(async(d,l,u)=>{const t=await fetch(d,{method:u?.method||"POST",headers:{...h({json:!1}),...u?.headers||{}},body:l,credentials:u?.credentials});if(!t.ok){let o=`Request failed (${t.status})`;try{const b=await t.json();o=b.error||b.message||o}catch{try{o=await t.text()||o}catch{}}throw new Error(o)}try{return await t.json()}catch{return}},[h]);return{apiBase:N,buildHeaders:h,fetchJson:x,fetchForm:w}}function F(){const{apiBase:s,fetchJson:a}=P(),[p,N]=c.useState(void 0),[h,x]=c.useState(!1),[w,d]=c.useState(void 0),l=c.useCallback(async()=>{x(!0),d(void 0);try{const t=await a(`${s}/orgs`,{credentials:"include"}),b=(Array.isArray(t)?t:Array.isArray(t?.orgs)?t.orgs:[]).map(j=>({...j,id:S(j.id)||j.id}));N(b)}catch(t){d(t instanceof Error?t.message:"Unknown error")}finally{x(!1)}},[s,a]),u=c.useCallback(async t=>{const o=await a(`${s}/orgs`,{method:"POST",body:{name:t},credentials:"include"});return N(b=>b?[{...o,id:S(o.id)||o.id},...b]:[{...o,id:S(o.id)||o.id}]),o},[s,a]);return c.useEffect(()=>{l().catch(()=>{})},[l]),{orgs:p,loading:h,error:w,refresh:l,createOrg:u}}const E=()=>{const{orgs:s,loading:a,error:p,createOrg:N}=F(),{config:h,setActiveOrg:x}=_(),{logout:w}=O(),[d,l]=c.useState(""),[u,t]=c.useState(!1),[o,b]=c.useState(void 0),[j,g]=c.useState(void 0),z=h.activeOrgId;h.activeOrgName;const n=c.useMemo(()=>s?[...s].sort((r,f)=>r.name.localeCompare(f.name)):[],[s]),v=(r,f)=>{x(r,f),g(`Switched to ${f}`),window.setTimeout(()=>g(void 0),2500)},m=async()=>{if(d.trim())try{t(!0),b(void 0);const r=await N(d.trim());x(r.id,r.name),l(""),document.getElementById("modal-create-org")?.click?.(),g(`Organization “${r.name}” created`),window.setTimeout(()=>g(void 0),2500)}catch(r){b(r.message||"Failed to create organization")}finally{t(!1)}};return e.jsxs("div",{className:"dropdown-bottom ms-1 dropdown dropdown-end","data-testid":"profile-menu",children:[e.jsx("div",{tabIndex:0,className:"cursor-pointer","data-testid":"avatar-trigger",children:e.jsx("div",{className:"bg-base-200 rounded-full ring ring-success size-7 overflow-hidden avatar",children:e.jsx("img",{src:"/images/avatars/1.png",alt:"Avatar","data-testid":"avatar-image"})})}),e.jsxs("div",{tabIndex:0,className:"bg-base-100 shadow mt-2 rounded-box w-44 dropdown-content",children:[e.jsxs("ul",{className:"p-2 w-full menu",children:[e.jsx("li",{children:e.jsxs(k,{to:"#",children:[e.jsx(i,{icon:"lucide--user",className:"size-4"}),e.jsx("span",{children:"My Profile"})]})}),e.jsx("li",{children:e.jsxs(k,{to:"#",children:[e.jsx(i,{icon:"lucide--settings",className:"size-4"}),e.jsx("span",{children:"Settings"})]})}),e.jsx("li",{children:e.jsxs(k,{to:"#",children:[e.jsx(i,{icon:"lucide--help-circle",className:"size-4"}),e.jsx("span",{children:"Help"})]})})]}),e.jsx("div",{className:"opacity-70 px-3 pt-2 pb-1 text-xs",children:"Organizations"}),e.jsxs("ul",{className:"p-2 pt-0 w-full max-h-60 overflow-auto menu",children:[a&&e.jsx("li",{className:"disabled",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"rounded w-4 h-4 skeleton"}),e.jsx("span",{className:"w-24 h-3 skeleton"})]})}),!a&&n.length===0&&e.jsx("li",{className:"disabled",children:e.jsx("div",{className:"opacity-70",children:"No organizations"})}),!a&&n.map(r=>e.jsx("li",{children:e.jsxs("button",{className:"flex justify-between items-center",onClick:()=>v(r.id,r.name),"aria-current":r.id===z?"true":void 0,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{icon:"lucide--building-2",className:"size-4"}),e.jsx("span",{className:"truncate",title:r.name,children:r.name})]}),r.id===z&&e.jsx(i,{icon:"lucide--check",className:"size-4","aria-hidden":!0})]})},r.id))]}),e.jsx("div",{className:"px-2 pt-0 pb-2",children:e.jsx("label",{htmlFor:"modal-create-org",className:"link link-primary",children:"Add organization"})}),e.jsx("hr",{className:"border-base-300"}),e.jsxs("ul",{className:"p-2 w-full menu",children:[e.jsx("li",{children:e.jsxs("div",{children:[e.jsx(i,{icon:"lucide--arrow-left-right",className:"size-4"}),e.jsx("span",{children:"Switch Account"})]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",onClick:w,className:"flex items-center hover:bg-error/10 text-error","aria-label":"Logout",children:[e.jsx(i,{icon:"lucide--log-out",className:"size-4"}),e.jsx("span",{children:"Logout"})]})})]})]}),e.jsx("input",{type:"checkbox",id:"modal-create-org",className:"modal-toggle"}),e.jsxs("div",{className:"modal",role:"dialog","aria-modal":"true",children:[e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Create Organization"}),(p||o)&&e.jsxs("div",{className:"mt-2 alert alert-error",children:[e.jsx(i,{icon:"lucide--alert-triangle",className:"size-4"}),e.jsx("span",{children:o||p})]}),e.jsxs("div",{className:"mt-4 form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Organization name"})}),e.jsx("input",{className:"input",placeholder:"Acme Inc",value:d,maxLength:100,onChange:r=>l(r.target.value)})]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("label",{htmlFor:"modal-create-org",className:"btn btn-ghost",children:"Cancel"}),e.jsxs("button",{className:"btn btn-primary",onClick:m,disabled:u||!d.trim(),children:[u&&e.jsx("span",{className:"me-2 loading loading-spinner loading-sm"}),"Create"]})]})]}),e.jsx("label",{className:"modal-backdrop",htmlFor:"modal-create-org",children:"Close"})]}),j&&e.jsx("div",{className:"toast-top toast toast-end",children:e.jsxs("div",{className:"alert alert-success",children:[e.jsx(i,{icon:"lucide--check-circle-2",className:"size-4"}),e.jsx("span",{children:j})]})})]})};E.__docgenInfo={description:"",methods:[],displayName:"TopbarProfileMenu"};const $=()=>{const s=c.useRef(null),a=()=>s.current?.showModal();return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"hidden md:flex justify-start gap-2 border-base-300 btn-outline w-48 h-9 !text-sm text-base-content/70 btn btn-sm btn-ghost",onClick:a,children:[e.jsx(i,{icon:"lucide--search",className:"size-4"}),e.jsx("span",{children:"Search"})]}),e.jsx("button",{className:"md:hidden flex border-base-300 btn-outline size-9 text-base-content/70 btn btn-sm btn-square btn-ghost","aria-label":"Search",onClick:a,children:e.jsx(i,{icon:"lucide--search",className:"size-4"})}),e.jsxs("dialog",{ref:s,className:"p-0 modal",children:[e.jsx("div",{className:"bg-transparent shadow-none p-0 modal-box",children:e.jsx("div",{className:"bg-base-100 rounded-box",children:e.jsxs("div",{className:"border-0 !outline-none w-full input",children:[e.jsx(i,{icon:"lucide--search",className:"size-4.5 text-base-content/60"}),e.jsx("input",{type:"search",className:"grow",placeholder:"Search","aria-label":"Search"}),e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn btn-xs btn-circle btn-ghost","aria-label":"Close",children:e.jsx(i,{icon:"lucide--x",className:"size-4 text-base-content/80"})})})]})})}),e.jsx("form",{method:"dialog",className:"modal-backdrop",children:e.jsx("button",{children:"close"})})]})]})};$.__docgenInfo={description:"",methods:[],displayName:"TopbarSearchButton"};const I=({hoverMode:s=!1,className:a,...p})=>{const N=s?"layout-sidebar-hover-trigger":"layout-sidebar-toggle-trigger",h="btn btn-square btn-ghost btn-sm",x=s?"hidden group-has-[[id=layout-sidebar-hover-trigger]:checked]/html:flex":"group-has-[[id=layout-sidebar-hover-trigger]:checked]/html:hidden";return e.jsx("label",{htmlFor:N,"aria-label":"Leftmenu toggle",className:`${h} ${x} ${a??""}`,...p,children:e.jsx(i,{icon:"lucide--menu",className:"size-5"})})};I.__docgenInfo={description:"",methods:[],displayName:"TopbarLeftmenuToggle",props:{hoverMode:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}},composes:["ComponentProps"]};const L=({className:s,...a})=>e.jsx("label",{htmlFor:"layout-rightbar-drawer",className:`btn btn-circle btn-ghost btn-sm drawer-button ${s??""}`,...a,children:e.jsx(i,{icon:"lucide--settings-2",className:"size-4.5"})});L.__docgenInfo={description:"",methods:[],displayName:"TopbarRightbarButton"};const C=({className:s})=>e.jsxs("div",{role:"navigation","aria-label":"Navbar",id:"layout-topbar",className:`flex justify-between items-center px-3 ${s??""}`,children:[e.jsxs("div",{className:"inline-flex items-center gap-3",children:[e.jsx(I,{}),e.jsx(I,{hoverMode:!0}),e.jsx($,{})]}),e.jsxs("div",{className:"inline-flex items-center gap-0.5",children:[e.jsx(B,{className:"btn btn-sm btn-circle btn-ghost"}),e.jsx(L,{}),e.jsx(A,{}),e.jsx(E,{})]})]});C.__docgenInfo={description:"",methods:[],displayName:"Topbar",props:{className:{required:!1,tsType:{name:"string"},description:""}}};const H={title:"Organisms/Topbar",component:C,args:{},parameters:{layout:"fullscreen",docs:{description:{component:"Topbar organism providing primary horizontal navigation shell; composes toggle, search, notifications, profile, and theme switch."}}}},y={render:s=>e.jsx("div",{className:"border border-base-300 bg-base-100",children:e.jsx(C,{...s})})},T={args:{className:"bg-base-200"},render:s=>e.jsx("div",{className:"border border-base-300 bg-base-100",children:e.jsx(C,{...s})})};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:`{
  render: (args: TopbarProps) => <div className="border border-base-300 bg-base-100">
      <Topbar {...args} />
    </div>
}`,...y.parameters?.docs?.source}}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  args: {
    className: 'bg-base-200'
  },
  render: (args: TopbarProps) => <div className="border border-base-300 bg-base-100">
      <Topbar {...args} />
    </div>
}`,...T.parameters?.docs?.source}}};const V=["Default","WithCustomClass"];export{y as Default,T as WithCustomClass,V as __namedExportsOrder,H as default};
