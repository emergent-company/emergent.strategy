# =============================================================================
# SERVER APPLICATION - REMOTE SERVICES CONFIGURATION
# =============================================================================
#
# This file configures the NestJS server to connect to REMOTE services
# running on dev.emergent-company.ai (94.130.12.194)
#
# USAGE:
#   1. Copy this file to apps/server/.env.local:
#      cp apps/server/.env.local.remote apps/server/.env.local
#
#   2. Update secrets (JWT files, API keys) with your actual values
#
#   3. Start server:
#      nx run workspace-cli:workspace:start -- --skip-deps
#
# =============================================================================

# -----------------------------------------------------------------------------
# Core Server Configuration (keep local)
# -----------------------------------------------------------------------------
PORT=3002
NODE_ENV=development
CORS_ORIGIN=http://localhost:5176

# -----------------------------------------------------------------------------
# Remote Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_HOST=94.130.12.194
POSTGRES_PORT=5432
POSTGRES_USER=spec
POSTGRES_PASSWORD=spec
POSTGRES_DB=zitadel

# Database initialization (disable for remote)
DB_AUTOINIT=false
SKIP_DB=0
SKIP_MIGRATIONS=0

# E2E testing database (keep local name)
POSTGRES_DB_E2E=spec_e2e

# Row-Level Security
APP_RLS_PASSWORD=
RLS_POLICY_STRICT=false

# -----------------------------------------------------------------------------
# Remote Authentication & Authorization (Zitadel)
# -----------------------------------------------------------------------------
# Zitadel OIDC issuer (remote)
ZITADEL_ISSUER=http://zitadel.dev.emergent-company.ai:8100

# Service Account JWT (CLIENT - for token introspection)
# TODO: Copy content from remote PAT or create new service account
ZITADEL_CLIENT_JWT=

# Alternative: Path to JWT file (if you have the file locally)
# ZITADEL_CLIENT_JWT_PATH=./secrets-dev/client-service-account.json

# API Service Account JWT (API - for Management API operations)
# TODO: Copy content from remote PAT or create new service account
ZITADEL_API_JWT=

# Alternative: Path to JWT file
# ZITADEL_API_JWT_PATH=./secrets-dev/api-service-account.json

# Organization and Project IDs (from remote bootstrap)
ZITADEL_MAIN_ORG_ID=347883699234147332

# Organization ID specifically (used by some modules)
ZITADEL_ORG_ID=347883699234147332

# Project ID (from remote bootstrap)
ZITADEL_PROJECT_ID=347883699653577732

# Development flags
SCOPES_DISABLED=0
# DEBUG_AUTH_SCOPES=1
# DEBUG_AUTH_CLAIMS=1
# DEBUG_TENANT=1

# -----------------------------------------------------------------------------
# Google Cloud Platform (same as local)
# -----------------------------------------------------------------------------
GCP_PROJECT_ID=spec-server

# TODO: Add your actual Google API key
GOOGLE_API_KEY=

# Path to GCP credentials JSON (if using service account)
# GOOGLE_APPLICATION_CREDENTIALS=./path/to/gcp-credentials.json

GOOGLE_REDIRECT_URL=http://localhost:3002/oauth/callback

# -----------------------------------------------------------------------------
# AI & LLM Configuration (same as local)
# -----------------------------------------------------------------------------
VERTEX_AI_LOCATION=us-central1
VERTEX_AI_MODEL=gemini-2.5-flash-lite
EMBEDDING_PROVIDER=vertex
EMBEDDING_DIMENSION=768
EMBEDDINGS_NETWORK_DISABLED=false

# Chat configuration
CHAT_MODEL_ENABLED=true
CHAT_SYSTEM_PROMPT=
CHAT_TITLE_GENERATION_ENABLED=true
CHAT_TITLE_MAX_LENGTH=60
CHAT_TITLE_MIN_MESSAGES=2

# -----------------------------------------------------------------------------
# Extraction Worker Configuration
# -----------------------------------------------------------------------------
EXTRACTION_WORKER_ENABLED=false
EXTRACTION_WORKER_POLL_INTERVAL_MS=5000
EXTRACTION_WORKER_BATCH_SIZE=5
EXTRACTION_RATE_LIMIT_RPM=60
EXTRACTION_RATE_LIMIT_TPM=30000
EXTRACTION_ENTITY_LINKING_STRATEGY=always_new
EXTRACTION_CONFIDENCE_THRESHOLD_MIN=0.0
EXTRACTION_CONFIDENCE_THRESHOLD_REVIEW=0.7
EXTRACTION_CONFIDENCE_THRESHOLD_AUTO=0.85
EXTRACTION_DEFAULT_TEMPLATE_PACK_ID=
EXTRACTION_CHUNK_SIZE=100000
EXTRACTION_CHUNK_OVERLAP=2000
EXTRACTION_BASE_PROMPT=

# -----------------------------------------------------------------------------
# Observability (optional)
# -----------------------------------------------------------------------------
LANGSMITH_TRACING=false
LANGSMITH_ENDPOINT=
LANGSMITH_API_KEY=
LANGSMITH_PROJECT=

# -----------------------------------------------------------------------------
# Seeding & Testing (disable for remote)
# -----------------------------------------------------------------------------
ORGS_DEMO_SEED=false
BIBLE_SEED_API_URL=
BIBLE_SEED_ACCESS_TOKEN=
BIBLE_SEED_RATE_LIMIT_MS=100

# -----------------------------------------------------------------------------
# SECURITY NOTES
# -----------------------------------------------------------------------------
#
# 1. ZITADEL SERVICE ACCOUNTS:
#    - You need JWT tokens for CLIENT and API service accounts
#    - Option A: Copy existing PAT from remote server (temporary)
#    - Option B: Create new service accounts via Zitadel Console
#      (Recommended: http://zitadel.dev.emergent-company.ai:8100/ui/console)
#
# 2. GOOGLE API KEY:
#    - Required for AI/LLM features (Gemini, embeddings, extraction)
#    - Get from: https://console.cloud.google.com/apis/credentials
#    - Must have Vertex AI API and Generative Language API enabled
#
# 3. DATABASE PASSWORD:
#    - Currently using default "spec" password
#    - Consider changing for production/security
#
# 4. NEVER COMMIT THIS FILE:
#    - .env.local is gitignored
#    - Keep all secrets in .env.local files only
#
# =============================================================================
