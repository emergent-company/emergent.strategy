{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "org_ops_definition_schema.json",
  "title": "EPF OrgOps Process Definition Schema",
  "version": "1.1.0",
  "description": "Schema for OrgOps track process definitions. Extends track_definition_base_schema.json with process-specific fields (steps, cadence, compliance, practitioner_scenarios, risks, domain_context). Process definitions are input for operations teams to run organizational processes.",
  "$comment": "OrgOps definitions cover: Talent Management (onboarding, training, performance), Culture & Communications (values, collaboration, feedback), Financial & Legal (budgeting, compliance, risk), Facilities & IT (infrastructure, systems, tools). These are canonical templates usable by any organization. Version 1.1: Added practitioner_scenarios, risks, and domain_context fields for richer practitioner guidance.",
  "allOf": [
    {
      "$ref": "track_definition_base_schema.json"
    },
    {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^pd-[0-9]{3}$",
          "description": "Process definition ID. Format: pd-{number}"
        },
        "track": {
          "const": "org_ops"
        },
        "definition": {
          "type": "object",
          "properties": {
            "steps": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["step", "action", "responsible"],
                "properties": {
                  "step": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Step number in sequence"
                  },
                  "action": {
                    "type": "string",
                    "description": "What to do in this step"
                  },
                  "responsible": {
                    "type": "string",
                    "description": "Role responsible for this step"
                  },
                  "duration": {
                    "type": "string",
                    "description": "Typical time for this step",
                    "examples": ["15 minutes", "1 hour", "1 day"]
                  },
                  "tools": {
                    "type": "array",
                    "items": {"type": "string"},
                    "description": "Suggested tools (not mandated)"
                  },
                  "deliverable": {
                    "type": "string",
                    "description": "What this step produces"
                  }
                }
              },
              "minItems": 1,
              "maxItems": 10,
              "description": "Sequential steps to execute this process. Keep to 5-7 for Tier 1 (narrow scope).",
              "$comment": "Steps are the core of OrgOps definitions. Each step should be atomic and have clear ownership. If >10 steps, consider splitting into multiple definitions. Tier 1 definitions focus on essential steps only."
            },
            "cadence": {
              "type": "object",
              "description": "When and how often this process runs",
              "properties": {
                "frequency": {
                  "type": "string",
                  "enum": ["one-time", "daily", "weekly", "bi-weekly", "monthly", "quarterly", "annually", "on-demand", "event-triggered"],
                  "description": "How often this process executes"
                },
                "trigger": {
                  "type": "string",
                  "description": "What initiates this process (for event-triggered processes)",
                  "examples": ["New hire start date", "Employee request", "Compliance deadline", "Budget cycle start"]
                },
                "duration": {
                  "type": "string",
                  "description": "Total time from start to completion",
                  "examples": ["4 hours", "1 day", "1 week"]
                }
              }
            },
            "participants": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "role": {"type": "string"},
                  "responsibility": {"type": "string"},
                  "time_commitment": {"type": "string"}
                }
              },
              "description": "All roles involved in this process"
            }
          }
        },
        "operational_context": {
          "type": "object",
          "description": "OrgOps-specific context for process execution",
          "properties": {
            "prerequisites": {
              "type": "array",
              "items": {"type": "string"},
              "description": "What must be in place before this process can run"
            },
            "common_blockers": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Typical obstacles and how to address them"
            },
            "metrics": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {"type": "string"},
                  "description": {"type": "string"},
                  "target": {"type": "string"},
                  "tier": {
                    "type": "integer",
                    "enum": [1, 2, 3],
                    "description": "Which maturity tier introduces this metric"
                  }
                }
              },
              "description": "Process metrics for tracking effectiveness"
            }
          }
        },
        "compliance": {
          "type": "object",
          "description": "Regulatory and policy compliance considerations",
          "properties": {
            "regulatory_requirements": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Applicable regulations (GDPR, SOX, ISO, etc.)"
            },
            "documentation_required": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Records that must be kept"
            },
            "audit_considerations": {
              "type": "string",
              "description": "What auditors typically look for"
            }
          }
        },
        "tools_ecosystem": {
          "type": "object",
          "description": "Tool recommendations (suggestions, not mandates)",
          "properties": {
            "recommended": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "category": {"type": "string"},
                  "examples": {
                    "type": "array",
                    "items": {"type": "string"}
                  },
                  "purpose": {"type": "string"}
                }
              }
            },
            "integrations": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Common integration points with other systems"
            }
          }
        },
        "practitioner_scenarios": {
          "type": "array",
          "description": "Concrete scenarios showing how this process plays out in real organizations. Similar to feature scenarios but for operational processes.",
          "$comment": "Practitioner scenarios help operations teams understand how the process works in practice. Each scenario shows a realistic situation, the practitioner's actions, and outcomes. Include both 'happy path' and 'challenging' scenarios. Scenarios make abstract processes concrete and actionable.",
          "items": {
            "type": "object",
            "required": ["id", "name", "practitioner", "situation", "trigger", "actions", "outcome"],
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^ps-[0-9]+$",
                "description": "Unique scenario ID. Format: ps-{number}",
                "examples": ["ps-001", "ps-002"]
              },
              "name": {
                "type": "string",
                "minLength": 10,
                "description": "Descriptive name summarizing the scenario",
                "examples": ["First-time performance review with nervous manager", "Onboarding remote hire across timezones"]
              },
              "practitioner": {
                "type": "string",
                "description": "Who is executing this process (role, not person name)",
                "examples": ["HR Lead", "Engineering Manager", "CFO", "Office Manager"]
              },
              "organization_context": {
                "type": "string",
                "description": "Brief description of org size, stage, and relevant context",
                "examples": ["15-person seed-stage startup, mostly remote", "50-person Series B with 3 offices"]
              },
              "situation": {
                "type": "string",
                "minLength": 50,
                "description": "The specific situation that makes this scenario realistic and educational. Include relevant details about timing, pressures, and context."
              },
              "trigger": {
                "type": "string",
                "description": "What initiates this specific instance of the process"
              },
              "actions": {
                "type": "string",
                "minLength": 100,
                "description": "Step-by-step narrative of what the practitioner does, including decisions made and adaptations to standard process"
              },
              "outcome": {
                "type": "string",
                "minLength": 50,
                "description": "What happens as a result, including both process completion and lessons learned"
              },
              "lessons": {
                "type": "array",
                "items": {"type": "string"},
                "description": "Key takeaways for practitioners facing similar situations"
              }
            }
          }
        },
        "risks": {
          "type": "object",
          "description": "What can go wrong and how to prevent/mitigate. Helps practitioners anticipate and handle issues.",
          "$comment": "Risks section addresses both process execution risks (things that can go wrong during the process) and organizational risks (consequences of poorly executed process). Include likelihood and impact assessments to help prioritize attention.",
          "properties": {
            "execution_risks": {
              "type": "array",
              "description": "Things that can go wrong during process execution",
              "items": {
                "type": "object",
                "required": ["risk", "likelihood", "impact", "mitigation"],
                "properties": {
                  "risk": {
                    "type": "string",
                    "description": "What could go wrong"
                  },
                  "likelihood": {
                    "type": "string",
                    "enum": ["low", "medium", "high"],
                    "description": "How likely is this to occur"
                  },
                  "impact": {
                    "type": "string",
                    "enum": ["low", "medium", "high"],
                    "description": "How serious if it occurs"
                  },
                  "mitigation": {
                    "type": "string",
                    "description": "How to prevent or handle this risk"
                  }
                }
              }
            },
            "organizational_risks": {
              "type": "array",
              "description": "Business/organizational consequences of poorly executed process",
              "items": {
                "type": "object",
                "required": ["risk", "impact", "prevention"],
                "properties": {
                  "risk": {
                    "type": "string",
                    "description": "What organizational harm could result"
                  },
                  "impact": {
                    "type": "string",
                    "description": "How this affects the organization"
                  },
                  "prevention": {
                    "type": "string",
                    "description": "How proper process execution prevents this"
                  }
                }
              }
            }
          }
        },
        "domain_context": {
          "type": "object",
          "description": "Industry context, best practices, and benchmarks. Equivalent to 'market_context' in Product features but for organizational operations.",
          "$comment": "Domain context helps practitioners understand 'what good looks like' and where their organization sits relative to industry norms. This enables evidence-based decisions about process maturity investment.",
          "properties": {
            "industry_landscape": {
              "type": "string",
              "description": "Current state of this operational area across organizations. Trends, common approaches, maturity levels."
            },
            "best_practices": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Proven approaches from high-performing organizations"
            },
            "anti_patterns": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Common mistakes to avoid, with explanations"
            },
            "benchmarks": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "metric": {"type": "string"},
                  "poor": {"type": "string"},
                  "average": {"type": "string"},
                  "excellent": {"type": "string"},
                  "source": {"type": "string"}
                }
              },
              "description": "Industry benchmarks for key metrics"
            },
            "maturity_indicators": {
              "type": "object",
              "description": "Signs of process maturity at each tier",
              "properties": {
                "tier_1_signs": {
                  "type": "array",
                  "items": {"type": "string"},
                  "description": "Indicators that org is ready for Tier 1"
                },
                "tier_2_signs": {
                  "type": "array",
                  "items": {"type": "string"},
                  "description": "Indicators that org should move to Tier 2"
                },
                "tier_3_signs": {
                  "type": "array",
                  "items": {"type": "string"},
                  "description": "Indicators that org needs Tier 3"
                }
              }
            }
          }
        }
      }
    }
  ]
}
