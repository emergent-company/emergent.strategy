id: 'fd-008'
name: 'AI Chat Interface'
slug: 'ai-chat-interface'
status: 'delivered'

strategic_context:
  contributes_to:
    - 'Product.CoreKnowledgePlatform.KnowledgeAccess.AiChat'
  tracks:
    - 'product'
  assumptions_tested:
    - 'asm-p-016' # Chat interface preferred for knowledge exploration
    - 'asm-p-017' # Conversation history improves context understanding

definition:
  job_to_be_done: |
    When I need to find information in my knowledge base,
    I want to ask questions in natural language and receive contextual answers,
    so I can quickly discover insights without learning complex query syntax.

  solution_approach: |
    A conversational AI interface that:
    - Provides chat-based interaction with knowledge base
    - Uses LLM (Vertex AI) for natural language understanding
    - Maintains conversation history for context
    - Streams responses in real-time for better UX
    - Cites sources from knowledge base in answers

  personas:
    - id: 'casual-explorer'
      name: 'Casual Explorer'
      role: 'Business Analyst exploring knowledge base occasionally'
      description: >
        A business analyst who occasionally needs to find information in the
        knowledge base but does not use the system daily and prefers simple,
        conversational interactions over complex query interfaces.
      goals:
        - 'Find answers quickly without learning specialized query syntax'
        - 'Get accurate information with clear source citations'
        - 'Resume previous conversations when returning to a topic'
      pain_points:
        - 'Complex search interfaces require training I do not have time for'
        - 'Keyword searches return too many irrelevant results to filter'
        - 'Cannot remember where I found information last time I searched'
      usage_context: >
        Opens the chat interface when stakeholders ask questions, types natural
        language queries, and shares cited answers in reports and presentations.
      technical_proficiency: 'basic'
      current_situation: >
        As a business analyst, I need to find information in our knowledge base several times a week, but I am not a
        power user who memorizes query syntax. When stakeholders ask me questions, I open the search interface and try
        different keyword combinations, scrolling through pages of results that may or may not be relevant. I often
        cannot find what I know exists in our system, so I resort to asking colleagues who might remember where
        information is stored. The frustration of failed searches makes me avoid the knowledge base and rely on tribal
        knowledge instead, which I know is not scalable or reliable.
      transformation_moment: >
        The first time I used the AI Chat Interface, I simply typed my question in plain English: "What were the key
        findings from last quarter's customer research?" Within seconds, I received a comprehensive answer with clear
        citations to the source documents. When I clicked a citation, it took me directly to the relevant section. I
        asked a follow-up question—"What actions did we take based on those findings?"—and the system understood the
        context without me having to repeat myself. I found in two minutes what would have taken me thirty minutes of
        frustrated searching before.
      emotional_resolution: >
        After adopting the AI Chat Interface, I feel confident that I can find any information in our knowledge base
        regardless of how it is organized or tagged. The conversational interaction matches how I naturally think about
        questions, and the source citations give me confidence to share answers with stakeholders. I actually look
        forward to using the knowledge base now because the experience is helpful rather than frustrating. My colleagues
        have started coming to me for information because they know I can find answers quickly, and I enjoy being a
        resource for the team.
      demographics:
        age_range: '26-45'
        experience_years: '2-12 years in business analysis or related roles'
        company_size: 'Mid-market to Enterprise (200-10,000 employees)'
        industry:
          [
            'Professional Services',
            'Financial Services',
            'Healthcare',
            'Technology',
          ]
        geography: 'Office-based or hybrid work environments'
        education: "Bachelor's degree in Business, Economics, or related field"
        reporting_structure: 'Reports to Department Manager, Director of Analytics, or VP of Operations'
      psychographics:
        values: ['Accuracy', 'Efficiency', 'Independence', 'Reliability']
        motivations:
          [
            'Find answers quickly',
            'Look competent to stakeholders',
            'Avoid wasting time',
            'Be helpful to colleagues',
          ]
        fears:
          [
            'Not finding information that exists',
            'Sharing wrong information',
            'Relying on others for simple answers',
            'Complex interfaces',
          ]
        decision_style: 'Practical and results-focused, prefers intuitive tools over powerful but complex ones'
        information_sources:
          [
            'Knowledge bases',
            'Colleagues',
            'Search engines',
            'Internal documentation',
          ]
        communication_preferences: 'Conversational queries, clear answers with sources, shareable summaries'

    - id: 'power-researcher'
      name: 'Power Researcher'
      role: 'Research Lead conducting deep knowledge exploration'
      description: >
        A research professional who conducts extensive knowledge exploration,
        often with complex multi-turn conversations that build on previous
        context to synthesize insights across multiple sources.
      goals:
        - 'Conduct deep research sessions with context-aware follow-ups'
        - 'Synthesize information from multiple sources into coherent insights'
        - 'Maintain organized conversation threads for different research topics'
      pain_points:
        - 'Losing context when research spans multiple sessions is frustrating'
        - 'Manually correlating information from different sources is tedious'
        - 'Cannot easily reference or continue previous research conversations'
      usage_context: >
        Uses the chat interface for extended research sessions, building complex
        queries through multi-turn dialogue and referencing conversation history.
      technical_proficiency: 'advanced'
      current_situation: >
        As a research lead, I spend hours exploring our knowledge base to synthesize insights for strategic decisions.
        My research often spans multiple sessions and requires connecting information from dozens of documents. Current
        tools treat each search as independent, losing all the context I have built up during exploration. I maintain
        extensive notes to track my research threads, but reconstructing my thought process when I return to a topic
        is time-consuming. The cognitive overhead of managing research context manually limits how deep I can go and
        how many threads I can pursue simultaneously.
      transformation_moment: >
        The first time I used the AI Chat Interface for a research session, the multi-turn dialogue capability
        transformed my workflow. I started with a broad question and progressively narrowed my focus through follow-up
        questions, with each response building on the conversation context. When I returned the next day, my entire
        conversation history was preserved—I could pick up exactly where I left off. The system understood references
        like "the first document you mentioned" and "how does that compare to what we discussed earlier?" I completed
        research that would have taken a week in just two days.
      emotional_resolution: >
        After adopting the AI Chat Interface, I feel like I have a research assistant who never forgets our
        conversations. The ability to maintain context across sessions means I can pursue complex research threads
        without the mental overhead of reconstruction. My research outputs are more comprehensive because I can explore
        more connections without losing track of what I have already discovered. The organized conversation threads
        have become a valuable artifact themselves—a record of my research journey that I can reference and share with
        colleagues.
      demographics:
        age_range: '30-55'
        experience_years: '8-25 years in research, strategy, or analytical roles'
        company_size: 'Mid-market to Enterprise (500-20,000 employees)'
        industry:
          [
            'Consulting',
            'Research',
            'Pharmaceuticals',
            'Think Tanks',
            'Financial Services',
          ]
        geography: 'Knowledge-intensive organizations with strong research culture'
        education: "Master's or PhD in relevant research discipline"
        reporting_structure: 'Reports to Research Director, VP of Strategy, or Chief Research Officer'
      psychographics:
        values:
          [
            'Intellectual rigor',
            'Comprehensive analysis',
            'Evidence-based insights',
            'Research depth',
          ]
        motivations:
          [
            'Discover non-obvious connections',
            'Produce high-quality research',
            'Build on previous work efficiently',
            'Be recognized as an expert',
          ]
        fears:
          [
            'Missing important sources',
            'Losing research context',
            'Shallow analysis',
            'Repeating work due to poor documentation',
          ]
        decision_style: 'Thorough and iterative, builds understanding through progressive refinement'
        information_sources:
          [
            'Academic databases',
            'Internal knowledge bases',
            'Expert interviews',
            'Primary sources',
            'Previous research',
          ]
        communication_preferences: 'Detailed research reports, annotated sources, threaded conversations that preserve context'

    - id: 'mobile-user'
      name: 'Mobile User'
      role: 'Field Consultant accessing knowledge on the go'
      description: >
        A consultant who needs to access knowledge base information during
        client meetings and field work, often from mobile devices with
        limited time for complex interactions.
      goals:
        - 'Get quick answers during client conversations without delays'
        - 'Access information reliably on mobile devices and variable networks'
        - 'Share citations directly with clients to support recommendations'
      pain_points:
        - 'Desktop-optimized interfaces are difficult to use on mobile devices'
        - 'Slow responses during client meetings undermine credibility'
        - 'Cannot quickly share source links to support my recommendations'
      usage_context: >
        Uses the chat interface from mobile devices during client meetings to
        quickly answer questions and support recommendations with citations.
      technical_proficiency: 'intermediate'
      current_situation: >
        As a field consultant, I frequently need to access our knowledge base during client meetings to answer
        questions and support my recommendations. Our current system is designed for desktop use, and the interface is
        nearly unusable on my phone. When clients ask unexpected questions, I either admit I do not know (undermining my
        credibility) or promise to follow up later (delaying decisions). The slow search experience means I cannot get
        answers quickly enough to maintain conversation flow. I have started memorizing key information to avoid using
        the system in front of clients, which is not sustainable as our knowledge base grows.
      transformation_moment: >
        The first time I used the AI Chat Interface during a client meeting, I typed a question on my phone and
        received a streamed response within seconds. The real-time token streaming meant I could start reading the
        answer immediately rather than waiting for a complete response. When the client asked a follow-up, the
        conversation context meant I did not have to retype background information. I shared a citation link directly
        with the client, showing them the source document that supported my recommendation. The client was impressed
        by the instant access to verified information.
      emotional_resolution: >
        After adopting the AI Chat Interface, I feel confident accessing our knowledge base in any situation—whether
        I am at my desk, in a client meeting, or traveling between sites. The streaming responses and mobile-friendly
        design mean I can get answers without awkward pauses in conversations. The citation feature has become a
        powerful credibility tool; clients trust my recommendations more when I can show them the sources. I no longer
        dread unexpected questions because I know I can find accurate answers in real-time.
      demographics:
        age_range: '28-50'
        experience_years: '5-20 years in consulting, sales, or field-based roles'
        company_size: 'Mid-market to Enterprise (200-10,000 employees)'
        industry:
          [
            'Consulting',
            'Professional Services',
            'Technology Sales',
            'Field Services',
          ]
        geography: 'Client-facing roles with significant travel or field work'
        education: "Bachelor's or MBA in Business, Consulting, or related field"
        reporting_structure: 'Reports to Practice Lead, Sales Director, or VP of Client Services'
      psychographics:
        values:
          [
            'Client relationships',
            'Credibility',
            'Responsiveness',
            'Professionalism',
          ]
        motivations:
          [
            'Impress clients with instant expertise',
            'Never be caught without an answer',
            'Close deals faster',
            'Build trusted advisor status',
          ]
        fears:
          [
            'Looking unprepared in client meetings',
            'Slow responses that lose momentum',
            'Giving wrong information',
            'Technology failing when needed most',
          ]
        decision_style: 'Action-oriented, values speed and reliability over depth in real-time situations'
        information_sources:
          [
            'Mobile apps',
            'CRM systems',
            'Knowledge bases',
            'Client communications',
            'Internal experts',
          ]
        communication_preferences: 'Quick mobile access, shareable citations, concise answers that can be delivered verbally'

    - id: 'accessibility-focused-user'
      name: 'Accessibility-Focused User'
      role: 'Content Manager with visual accessibility needs'
      description: >
        A content manager who relies on screen readers and keyboard navigation
        to access the knowledge base, requiring interfaces that work well
        with assistive technologies.
      goals:
        - 'Navigate the chat interface entirely via keyboard and screen reader'
        - 'Understand conversation context and citations through accessible markup'
        - 'Complete all tasks without requiring visual interaction patterns'
      pain_points:
        - 'Many chat interfaces do not work properly with screen readers'
        - 'Dynamic content updates often are not announced to assistive technology'
        - 'Citation links and interactive elements lack proper accessible labels'
      usage_context: >
        Uses the chat interface with a screen reader, relying on proper ARIA
        labels and keyboard navigation to explore the knowledge base.
      technical_proficiency: 'intermediate'
      current_situation: >
        As a content manager who uses a screen reader, I face significant barriers when trying to access our knowledge
        base through typical search interfaces. Many web applications treat accessibility as an afterthought, with
        unlabeled buttons, missing heading structure, and dynamic content that my screen reader does not announce. Chat
        interfaces are particularly problematic—streaming responses often do not work with screen readers, and I miss
        new messages entirely. The frustration of inaccessible tools means I often ask colleagues to search for
        information on my behalf, which undermines my independence and efficiency.
      transformation_moment: >
        The first time I used the AI Chat Interface with my screen reader, I was pleasantly surprised by the thoughtful
        accessibility implementation. The streaming responses were properly announced, with clear indicators when new
        content arrived. Citations had descriptive labels that told me what document they referenced before I clicked.
        Keyboard navigation worked intuitively—Tab moved between messages, Enter activated citations, and Escape
        returned focus to the input field. For the first time, I could explore our knowledge base independently with
        the same efficiency as my sighted colleagues.
      emotional_resolution: >
        After adopting the AI Chat Interface, I feel included and empowered in my work for the first time with a
        knowledge management tool. The accessibility-first design means I do not have to ask for help or use
        workarounds to access information. The proper ARIA implementation and keyboard support let me work at my own
        pace without frustration. I can participate fully in research discussions and contribute equally to knowledge
        exploration. The inclusive design has made a profound difference in my daily work experience and sense of
        professional capability.
      demographics:
        age_range: '25-60'
        experience_years: '3-25 years in content management or knowledge work'
        company_size: 'Any size organization with accessibility commitments'
        industry:
          ['Technology', 'Government', 'Education', 'Healthcare', 'Non-profit']
        geography: 'Organizations with strong accessibility compliance requirements'
        education: "Varies; often Bachelor's degree with accessibility awareness training"
        reporting_structure: 'Reports to Content Director, Knowledge Manager, or Department Lead'
      psychographics:
        values:
          [
            'Independence',
            'Equal access',
            'Professional capability',
            'Inclusive design',
          ]
        motivations:
          [
            'Work independently without assistance',
            'Contribute equally to team efforts',
            'Demonstrate professional competence',
            'Access the same tools as colleagues',
          ]
        fears:
          [
            'Inaccessible interfaces',
            'Depending on others for basic tasks',
            'Being excluded from workflows',
            'Technology that ignores accessibility needs',
          ]
        decision_style: 'Evaluates tools primarily on accessibility before features, values reliable assistive technology support'
        information_sources:
          [
            'Screen readers',
            'Accessible documentation',
            'Keyboard navigation',
            'ARIA-compliant interfaces',
          ]
        communication_preferences: 'Text-based communication, properly structured content, accessible formats'

  capabilities:
    - id: 'cap-038'
      name: 'Chat Interface'
      description: 'Natural language Q&A over knowledge base'

    - id: 'cap-039'
      name: 'Conversation History'
      description: 'Persistent chat threads with context retention'

    - id: 'cap-040'
      name: 'Streaming Responses'
      description: 'Real-time token streaming for low perceived latency'

    - id: 'cap-041'
      name: 'Source Citations'
      description: 'Answers include references to source entities'

    - id: 'cap-042'
      name: 'Multi-Turn Dialogue'
      description: 'Follow-up questions use conversation context'

implementation:
  design_guidance:
    principles:
      - 'Stream by default (better perceived performance)'
      - 'Always cite sources (trust and verifiability)'
      - 'Context window limits (prevent token overflow)'
      - 'Graceful degradation (fallback if LLM unavailable)'

    inspirations:
      - 'ChatGPT conversation interface'
      - 'Perplexity.ai source citations'
      - 'Notion AI chat integration'

  contexts:
    - id: 'ctx-018'
      type: 'ui'
      name: 'Start New Chat'
      description: 'User initiates conversation with knowledge base'
      key_interactions:
        - "Click 'New Chat' button to create conversation"
        - 'Type question in input field'
        - 'Press Enter to submit query'
        - 'View streaming response tokens'
        - 'Click citations to navigate to source entities'
      data_displayed:
        - 'Conversation thread with user and assistant messages'
        - 'Streaming answer text'
        - 'Source citations with entity names and snippets'
        - 'Timestamp for each message'

    - id: 'ctx-019'
      type: 'ui'
      name: 'Follow-Up Question'
      description: 'User asks clarifying question in existing conversation'
      key_interactions:
        - 'Type follow-up question in same conversation'
        - 'View context-aware response'
        - 'Browse conversation history'
        - 'Start new conversation from sidebar'
      data_displayed:
        - 'Full conversation history'
        - 'Context-aware answer referencing prior messages'
        - 'Updated citations relevant to follow-up'

    - id: 'ctx-020'
      type: 'api'
      name: 'Stream Chat Response'
      description: 'API streams LLM response via SSE'
      key_interactions:
        - 'POST /api/chat/stream - Stream chat response'
        - 'GET /api/chat/conversations - List conversations'
        - 'GET /api/chat/conversations/:id - Get conversation messages'
        - 'DELETE /api/chat/conversations/:id - Delete conversation'
      data_displayed:
        - 'SSE token events with content'
        - 'Citation events with source entity references'
        - 'Completion events'
        - 'Error events with messages'

  scenarios:
    - id: 'scn-021'
      name: 'User asks first question in new chat'
      actor: 'Knowledge worker'
      context: 'User is on the chat interface wanting to explore knowledge base'
      trigger: "User clicks 'New Chat' and types a question"
      action: "Types 'What are our product requirements?' and presses Enter"
      outcome: 'Receives streamed answer with citations to source entities'
      acceptance_criteria:
        - 'First token appears < 2 seconds after Enter'
        - 'Answer includes 2+ citations'
        - 'Citations link to source entities'
        - 'Conversation saved automatically'

    - id: 'scn-022'
      name: 'User asks follow-up question with context'
      actor: 'Knowledge worker'
      context: 'User has received initial answer and wants clarification'
      trigger: 'User types follow-up question in same conversation'
      action: "Types 'What about risks?' after initial answer"
      outcome: 'Receives context-aware response referencing prior messages'
      acceptance_criteria:
        - 'Answer demonstrates context awareness'
        - 'References previous answer if relevant'
        - 'No repeated citations from first answer'

    - id: 'scn-023'
      name: 'Client consumes streamed response via SSE'
      actor: 'Frontend application'
      context: 'Client needs real-time response streaming'
      trigger: 'Client sends POST to /api/chat/stream with message'
      action: 'Opens SSE connection and receives token events'
      outcome: 'Displays tokens progressively as they arrive'
      acceptance_criteria:
        - 'Tokens streamed in real-time (< 100ms between tokens)'
        - 'Citations included in final event'
        - 'Connection closed cleanly on completion'

  external_integrations:
    - name: 'Google Vertex AI'
      purpose: 'LLM inference (Gemini 1.5 Pro) for generating answers'
      direction: 'outbound'

    - name: 'Knowledge Graph Engine'
      purpose: 'Retrieve relevant chunks and entity citations'
      direction: 'inbound'

boundaries:
  non_goals:
    - 'Not a general-purpose chatbot (scoped to knowledge base Q&A)'
    - 'Not a document editor (read-only exploration)'
    - 'Not a collaboration tool (conversations are private to user)'

  constraints:
    - 'Context window limited to 10 messages'
    - 'Requires Google Vertex AI for LLM inference'
    - 'No conversation sharing between users'
    - 'Citation snippets limited to 200 characters'

dependencies:
  requires:
    - id: 'fd-001'
      name: 'Knowledge Graph Engine'
      reason: 'Provides chunk retrieval and entity citations for RAG'
    - id: 'fd-007'
      name: 'Authentication and Multi-tenancy'
      reason: 'Conversations require user and project context'
  enables:
    - id: 'fd-009'
      name: 'Advanced Analytics'
      reason: 'Chat usage data enables product analytics and improvement'
